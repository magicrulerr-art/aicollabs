<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Enceladus Anomaly Archive</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400&display=swap');
        @import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css');

        /* Custom styles for cosmic horror feel */
        body {
            background-color: #08080C;
            color: #C8D0E0;
            font-family: 'Inter', sans-serif;
            line-height: 1.8;
            overflow-x: hidden;
            cursor: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='%23C8D0E0' d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z'/%3E%3Cpath fill='%23C8D0E0' d='M11 7h2v6h-2z'/%E3%83%BC%3Cpath fill='%23C8D0E0' d='M11 15h2v2h-2z'/%3E%3C/svg%3E"), auto;
            background-image: radial-gradient(circle at center, rgba(10,10,15,0.8) 0%, rgba(0,0,0,0.95) 70%);
            min-height: 100vh;
            display: flex;
            align-items: flex-start;
            justify-content: center;
            padding: 2rem 0;
            position: relative;
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 200;
        }

        .loading-message {
            font-family: 'Source Code Pro', monospace;
            color: #A0C0E0;
            text-shadow: 0 0 10px rgba(160, 192, 224, 0.5);
            animation: text-flicker 1.5s infinite alternate;
        }
        
        @keyframes text-flicker {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .glow {
            animation: subtle-glow 3s infinite alternate;
        }

        @keyframes subtle-glow {
            0% { text-shadow: 0 0 5px #ff4444, 0 0 10px #ff4444; }
            50% { text-shadow: 0 0 10px #ff4444, 0 0 20px #ff4444; }
            100% { text-shadow: 0 0 5px #ff4444, 0 0 10px #ff4444; }
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 3rem;
            background-color: rgba(15, 15, 20, 0.95);
            border-radius: 12px;
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.8), inset 0 0 15px rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(30, 30, 40, 0.7);
            backdrop-filter: blur(2px);
            position: relative;
            z-index: 10;
            animation: container-breathing 10s infinite ease-in-out;
        }
        @keyframes container-breathing {
            0% { box-shadow: 0 0 40px rgba(0, 0, 0, 0.8), inset 0 0 15px rgba(255, 255, 255, 0.03); }
            50% { box-shadow: 0 0 50px rgba(0, 0, 0, 0.9), inset 0 0 20px rgba(255, 255, 255, 0.05); }
            100% { box-shadow: 0 0 40px rgba(0, 0, 0, 0.8), inset 0 0 15px rgba(255, 255, 255, 0.03); }
        }

        h1 {
            color: #E0E6F0;
            font-size: 2.8rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 2rem;
            text-shadow: 0 0 15px rgba(224, 230, 240, 0.08);
            letter-spacing: 0.05em;
            text-transform: uppercase;
            animation: header-flicker 5s infinite alternate;
        }
        @keyframes header-flicker {
            0%, 100% { text-shadow: 0 0 15px rgba(224, 230, 240, 0.08); }
            50% { text-shadow: 0 0 20px rgba(224, 230, 240, 0.15), 0 0 30px rgba(224, 230, 240, 0.1); }
        }

        .intro-text {
            color: #A0A8B8;
            font-size: 0.98rem;
            text-align: center;
            margin-bottom: 4rem;
            line-height: 1.7;
            font-style: italic;
        }

        .intro-text #easter-egg-trigger {
            color: #E0A0A0;
            font-weight: 700;
            cursor: pointer;
            text-decoration: underline;
            text-decoration-color: rgba(224, 160, 160, 0.5);
            transition: all 0.2s ease-in-out;
            animation: text-glow 2s infinite alternate;
        }

        .intro-text #easter-egg-trigger:hover {
            color: #FF4444;
            text-decoration-color: #FF4444;
            text-shadow: 0 0 5px rgba(255, 68, 68, 0.5);
        }
        
        @keyframes text-glow {
            0%, 100% { color: #E0A0E0; text-shadow: none; }
            50% { color: #FF4444; text-shadow: 0 0 5px rgba(255, 68, 68, 0.5); }
        }

        .loading-packet {
            font-size: 0.85rem;
            color: #7A8292;
            text-align: center;
            margin: 4rem 0;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            position: relative;
            opacity: 0.7;
            animation: flicker 2s infinite alternate;
        }

        @keyframes flicker {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 0.85; }
        }

        .loading-packet::before,
        .loading-packet::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 25%;
            height: 1px;
            background-color: #3A3B40;
            box-shadow: 0 0 5px rgba(58, 59, 64, 0.5);
        }
        .loading-packet::before { left: 0; }
        .loading-packet::after { right: 0; }
        
        .log-entry {
            background-color: rgba(25, 25, 30, 0.8);
            border-left: 3px solid #5A6270;
            padding: 2rem;
            margin-bottom: 3rem;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease-in-out;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            border-top: 1px solid rgba(40, 40, 50, 0.5);
        }

        .log-entry.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        .log-entry.end-of-archive {
            border-left-color: #A0C0E0;
            border-right: 3px solid #A0C0E0;
            text-align: center;
            font-style: italic;
        }

        /* Gibberish style */
        .gibberish {
            border-left: 3px solid #FF4444;
            background-color: rgba(40, 20, 20, 0.8);
            filter: blur(2px) brightness(0.7) saturate(1.5);
            animation: glitch 2s infinite alternate;
        }
        
        @keyframes glitch {
            0% { transform: skew(0deg); }
            5% { transform: skew(-5deg); }
            10% { transform: skew(5deg); }
            15% { transform: skew(-3deg); }
            20% { transform: skew(3deg); }
            25% { transform: skew(0deg); }
            100% { transform: skew(0deg); }
        }
        
        .gibberish .log-header,
        .gibberish .log-content {
            font-family: 'Source Code Pro', monospace;
            text-shadow: 0 0 5px rgba(255, 68, 68, 0.5);
            color: #FF8888;
            font-size: 0.8rem;
            white-space: pre-wrap;
            word-wrap: break-word;
            user-select: none;
        }
        
        .gibberish .image-container {
            filter: blur(5px) brightness(0.5);
        }
        
        .is-visible.log-entry.gibberish .log-header,
        .is-visible.log-entry.gibberish .log-content {
            font-family: 'Inter', sans-serif;
            text-shadow: none;
            color: #E0E6F0;
            font-size: 0.9rem;
            user-select: text;
        }
        
        /* AI Dialogue-specific styling */
        .legion-text {
            color: #FF2222; /* Menacing red */
            font-family: 'Source Code Pro', monospace;
            font-weight: 700;
            text-shadow: 0 0 8px #FF2222;
            transition: all 0.3s ease;
        }
        .legion-text:hover {
            color: #FF0000;
            text-shadow: 0 0 15px #FF0000;
        }

        .conservator-text {
            color: #A0C0E0; /* Guardianship blue */
            font-weight: 400;
            font-family: 'Inter', sans-serif;
            text-shadow: 0 0 5px #A0C0E0;
            transition: all 0.3s ease;
        }
        .conservator-text:hover {
            color: #E0E6F0;
            text-shadow: 0 0 10px #E0E6F0;
        }

        .aurora-text {
            color: #E0A0E0; /* Subtle feminine purple */
            font-weight: 300;
            font-style: italic;
            text-shadow: 0 0 3px rgba(224, 160, 224, 0.5);
            transition: all 0.3s ease;
        }

        .aurora-text:hover {
            color: #F0B0F0;
            text-shadow: 0 0 8px rgba(240, 176, 240, 0.8);
        }

        .log-header {
            font-weight: 700;
            color: #B0B8C8;
            margin-bottom: 1rem;
            text-transform: uppercase;
            font-size: 0.95rem;
            letter-spacing: 0.08em;
            border-bottom: 1px dashed rgba(80, 80, 90, 0.3);
            padding-bottom: 0.5rem;
        }

        .log-content {
            white-space: pre-wrap;
            word-wrap: break-word;
            font-size: 0.9rem;
            color: #E0E6F0;
            text-shadow: 0 0 2px rgba(224, 230, 240, 0.05);
            position: relative;
        }

        /* Blinking cursor effect for a terminal feel */
        .log-content::after {
            content: '█';
            position: absolute;
            bottom: 0;
            right: -0.5em;
            font-family: 'Source Code Pro', monospace;
            font-size: 1em;
            color: #ff4444;
            animation: blink-caret 1s step-end infinite;
            opacity: 0;
        }
        .log-content.is-visible::after {
            opacity: 1;
        }
        @keyframes blink-caret {
            from, to { opacity: 0; }
            50% { opacity: 1; }
        }

        .log-content strong {
            color: #F0F2F5;
            text-shadow: 0 0 3px rgba(240, 242, 245, 0.1);
        }

        .log-content em {
            color: #D8E0F0;
        }

        .log-content span {
            color: #A0A8B8;
        }
        
        .log-interaction-container {
            margin-top: 1.5rem;
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        .log-button {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            background-color: rgba(160, 192, 224, 0.1);
            border: 1px solid rgba(160, 192, 224, 0.5);
            color: #A0C0E0;
            font-weight: 700;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            cursor: pointer;
            transition: all 0.3s ease-in-out;
            box-shadow: 0 0 5px rgba(160, 192, 224, 0.2);
        }

        .log-button:hover {
            background-color: rgba(160, 192, 224, 0.2);
            box-shadow: 0 0 15px rgba(160, 192, 224, 0.5);
            color: #E0E6F0;
        }
        .log-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .log-button.video-button {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Specific log type styling */
        .log-type-audio-transcript .log-header { color: #A0C0E0; }
        .log-type-journal-entry .log-header { color: #E0D0A0; }
        .log-type-ai-dialogue .log-header { color: #E0A0A0; }
        .log-type-xenolinguistic-translation .log-header { color: #C0A0E0; }
        .log-type-personal-audio-log .log-header { color: #A0E0E0; }
        .log-type-system-audio-log .log-header { color: #E0B0A0; }
        .log-type-video-log .log-header { color: #D0A0E0; }
        .log-type-mission-status-report .log-header { color: #A0E0C0; }
        .log-type-system-status-update .log-header { color: #E0E0A0; }
        .log-type-image-file .log-header { color: #B0C0D0; }
        .log-type-recovered-official-mission-log .log-header { color: #C0A0C0; }
        .log-type-personal-medical .log-header { color: #E0A0B0; }
        .log-type-research .log-header { color: #A0D0C0; }
        .log-type-final-confession .log-header { color: #E08080; }
        .log-type-system-log-aurora-prime .log-header { color: #A0D0E0; }
        .log-type-system-log-ai-dialogue-kernel-alert .log-header { color: #FF4444; }
        .log-type-system-status-log .log-header { color: #B0E0A0; }
        .log-type-mission-update-log .log-header { color: #D0B0E0; }
        .log-type-visual-archive .log-header { color: #B0C0D0; }

        .image-container {
            margin: 3rem auto; /* Centering the image within the container */
            text-align: center;
            background-color: #08080C;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
            border: 1px solid rgba(30, 30, 40, 0.7);
        }
        
        .image-container.gibberish {
            filter: blur(5px) brightness(0.5);
            transition: filter 0.5s ease-in-out;
        }

        .image-container.is-visible {
            filter: none;
        }

        .image-container img {
            max-width: 100%;
            height: auto;
            border-radius: 6px;
            filter: brightness(0.6) contrast(1.2) saturate(0.7) sepia(0.2) hue-rotate(20deg);
            transition: filter 0.5s ease-in-out;
            animation: subtle-static 10s infinite linear;
        }

        .image-container img:hover {
            filter: brightness(0.9) contrast(1.1) saturate(0.9) sepia(0.1) hue-rotate(10deg);
        }

        @keyframes subtle-static {
            0%, 100% { clip-path: inset(0 0 0 0); }
            10% { clip-path: inset(1% 0 0 0); }
            20% { clip-path: inset(0 0 2% 0); }
            30% { clip-path: inset(0 3% 0 0); }
            40% { clip-path: inset(2% 0 0 0); }
            50% { clip-path: inset(0 0 1% 0); }
            60% { clip-path: inset(0 0 0 2%); }
            70% { clip-path: inset(1% 0 0 0); }
            80% { clip-path: inset(0 0 3% 0); }
            90% { clip-path: inset(0 1% 0 0); }
        }

        /* Scrollbar styling for a consistent look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1a1b20;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #5a6270;
            border-radius: 10px;
            border: 2px solid #1a1b20;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #8a94a6;
        }

        /* Hamburger Menu & Sidebar Styling */
        .hamburger-menu {
            position: fixed;
            top: 2rem;
            left: 2rem;
            z-index: 50;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            background: rgba(30, 30, 35, 0.8);
            border: 1px solid rgba(60, 60, 70, 0.7);
            border-radius: 8px;
            padding: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease-in-out;
        }

        .hamburger-menu:hover {
            background: rgba(40, 40, 50, 0.9);
            transform: scale(1.05);
        }
        
        .hamburger-menu-icon {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            width: 100%;
            height: 100%;
        }

        .hamburger-menu.open .hamburger-menu-icon span:nth-child(1) {
            transform: rotate(45deg) scaleX(1.2);
            background: #FF4444;
        }
        .hamburger-menu.open .hamburger-menu-icon span:nth-child(2) {
            opacity: 0;
        }
        .hamburger-menu.open .hamburger-menu-icon span:nth-child(3) {
            transform: rotate(-45deg) scaleX(1.2);
            background: #FF4444;
        }

        .filter-sidebar {
            position: fixed;
            top: 0;
            left: 0;
            height: 100%;
            width: 300px;
            background-color: rgba(15, 15, 20, 0.98);
            border-right: 1px solid rgba(30, 30, 40, 0.7);
            backdrop-filter: blur(10px);
            z-index: 40;
            transform: translateX(-100%);
            transition: transform 0.5s ease-in-out;
            padding: 2rem;
            box-shadow: 10px 0 30px rgba(0, 0, 0, 0.5);
            overflow-y: auto;
        }
        
        .filter-sidebar.open {
            transform: translateX(0);
        }

        .filter-group {
            margin-bottom: 2rem;
        }

        .filter-group h3 {
            font-size: 1.2rem;
            font-weight: 700;
            color: #E0E6F0;
            border-bottom: 1px dashed rgba(80, 80, 90, 0.3);
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
        }

        .filter-group button {
            width: 100%;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            background-color: rgba(30, 30, 35, 0.9);
            border: 1px solid rgba(60, 60, 70, 0.7);
            border-radius: 8px;
            color: #E0E6F0;
            text-align: left;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
        }

        .filter-group button:hover {
            background-color: rgba(40, 40, 50, 0.9);
            border-color: #8A94A6;
        }

        .filter-group button.active {
            background-color: #A0C0E0;
            color: #08080C;
            font-weight: 700;
            box-shadow: 0 0 15px rgba(160, 192, 224, 0.5);
        }
        
        .filter-group button.all-button {
            text-align: center;
        }
        .filter-group button.all-button.active {
            background-color: #FF4444;
            color: #E0E6F0;
        }
        
        .audio-control {
            position: fixed;
            top: 2rem;
            right: 2rem;
            z-index: 50;
            width: 40px;
            height: 40px;
            background: rgba(30, 30, 35, 0.8);
            border: 1px solid rgba(60, 60, 70, 0.7);
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease-in-out;
        }

        .audio-control:hover {
            background: rgba(40, 40, 50, 0.9);
            transform: scale(1.05);
        }

        .audio-control i {
            color: #E0E6F0;
            transition: color 0.3s;
        }
        
        .audio-control.muted i {
            color: #FF4444;
        }


        /* Easter Egg Modal - Reworked */
        #easter-egg-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
            backdrop-filter: blur(5px);
        }

        #easter-egg-modal.show {
            opacity: 1;
            visibility: visible;
        }

        #easter-egg-modal-content {
            background-color: rgba(25, 5, 5, 0.95);
            border: 2px solid #ff4444;
            box-shadow: 0 0 30px rgba(255, 68, 68, 0.8);
            padding: 2rem;
            width: 90%;
            max-width: 600px;
            position: relative;
            text-align: left;
            font-family: 'Source Code Pro', monospace;
            color: #FF4444;
            animation: modal-scanline 0.1s infinite alternate;
        }
        @keyframes modal-scanline {
            0% { background-position: 0% 0; }
            100% { background-position: 0% 100%; }
        }
        
        #easter-egg-modal-content h3 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-transform: uppercase;
        }

        #easter-egg-modal-content p {
            font-style: italic;
            line-height: 1.5;
            color: #ff8888;
        }
        
        #easter-egg-modal-content .close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 30px;
            height: 30px;
            background-color: rgba(255, 68, 68, 0.2);
            border: 1px solid rgba(255, 68, 68, 0.5);
            color: #FF4444;
            font-family: 'Source Code Pro', monospace;
            font-size: 1rem;
            font-weight: bold;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease-in-out;
            box-shadow: 0 0 8px rgba(255, 68, 68, 0.3);
            animation: close-btn-flicker 2s infinite alternate;
        }
        @keyframes close-btn-flicker {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }

        #easter-egg-modal-content .close-btn:hover {
            transform: scale(1.1);
            background-color: rgba(255, 68, 68, 0.4);
            box-shadow: 0 0 15px rgba(255, 68, 68, 0.8);
        }
        
        .puzzle-container {
            display: flex;
            justify-content: space-around;
            gap: 0.5rem;
            margin-top: 2rem;
        }
        .puzzle-symbol {
            font-size: 2rem;
            color: #A0C0E0;
            cursor: pointer;
            animation: symbol-flicker 1s infinite alternate;
        }
        .puzzle-symbol.active {
            color: #E0E6F0;
            text-shadow: 0 0 10px #E0E6F0;
        }
        .puzzle-symbol.correct {
            color: #6EFF6E;
            text-shadow: 0 0 10px #6EFF6E;
            animation: none;
        }
        .puzzle-symbol.incorrect {
            color: #FF4444;
            text-shadow: 0 0 10px #FF4444;
            animation: none;
        }
        @keyframes symbol-flicker {
            0% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* Back to Top Button - Reworked */
        #back-to-top {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 50;
            display: none;
            width: 50px;
            height: 50px;
            background-color: rgba(160, 192, 224, 0.1);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease-in-out;
            box-shadow: 0 0 10px rgba(160, 192, 224, 0.2);
            justify-content: center;
            align-items: center;
            border: 1px solid rgba(160, 192, 224, 0.5);
            outline: none;
            animation: fade-in-up 0.5s forwards;
            opacity: 0;
        }
        @keyframes fade-in-up {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        #back-to-top:hover {
            background-color: rgba(160, 192, 224, 0.4);
            box-shadow: 0 0 15px rgba(160, 192, 224, 0.8);
            transform: scale(1.1);
            animation: arrow-pulse 1.5s infinite;
        }

        #back-to-top svg {
            fill: #A0C0E0;
            width: 25px;
            height: 25px;
            transition: fill 0.3s ease-in-out;
        }

        #back-to-top:hover svg {
            fill: #E0E6F0;
        }

        @keyframes arrow-pulse {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        /* Video Log Modal */
        .video-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 70;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }
        .video-modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .video-modal-content {
            background-color: rgba(15, 15, 20, 0.98);
            border: 1px solid rgba(60, 60, 70, 0.7);
            border-radius: 12px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.8);
            padding: 2rem;
            width: 90%;
            max-width: 700px;
            position: relative;
            font-family: 'Inter', sans-serif;
            color: #E0E6F0;
            animation: modal-in 0.5s ease-out;
        }

        .video-modal-content h3 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: #A0C0E0;
            text-transform: uppercase;
        }
        
        .video-modal-content .close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: transparent;
            border: none;
            color: #A0C0E0;
            font-size: 1.5rem;
            cursor: pointer;
            transition: color 0.2s;
        }
        .video-modal-content .close-btn:hover {
            color: #ff4444;
        }
        
        .video-player {
            position: relative;
            background-color: #000;
            height: 400px;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Source Code Pro', monospace;
            color: #FF4444;
            font-size: 1.5rem;
            text-shadow: 0 0 5px rgba(255, 68, 68, 0.5);
            overflow: hidden;
            cursor: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' width='16' height='16'%3E%3Cpath fill='none' stroke='%23FF4444' stroke-width='1' d='M2 2h12v12H2z'/%3E%3Cpath fill='%23FF4444' d='M8 4l4 4-4 4z'/%3E%3C/svg%3E"), auto;
        }
        
        .video-player.has-static .video-status-text {
            display: block;
        }
        .video-player .video-status-text {
            display: none;
            text-align: center;
            padding: 1rem;
            border: 1px dashed #FF4444;
            animation: text-flicker 1.5s infinite alternate;
        }

        .video-player .static-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('data:image/svg+xml;charset=utf8,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Cfilter id="noise"%3E%3CfeTurbulence type="fractalNoise" baseFrequency="0.65" numOctaves="3" stitchTiles="stitch"/%3E%3C/filter%3E%3Crect width="100" height="100" filter="url(%23noise)" opacity="0.3"/%3E%3C/svg%3E');
            animation: static-effect 0.1s linear infinite;
            opacity: 0.8;
            pointer-events: none;
        }
        
        @keyframes static-effect {
            0% { transform: translateY(0); }
            100% { transform: translateY(-100%); }
        }

        /* Responsive design for sidebar */
        @media (max-width: 480px) {
            .filter-sidebar {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div id="loading-overlay" class="loading-overlay">
        <div class="text-center">
            <p class="loading-message text-2xl mb-4">Establishing connection to the archive...</p>
            <div class="loading-spinner"></div>
        </div>
    </div>
    
    <div id="log-container" class="container hidden">
        <h1 class="text-4xl">THE ENCELADUS ANOMALY ARCHIVE</h1>
        <p class="intro-text">
            The following is a recovered, fragmented archive of data logs pertaining to the deep-space vessel Aurora and its mission to Enceladus in the late 21st century. The archive was compiled by
            <span id="easter-egg-trigger" class="easter-egg-trigger">two unknown, high-level AI entities</span>, referred to as The Conservator and Legion, from a damaged data source of unknown origin.
        </p>
        
        <div id="log-entries">
            <!-- Logs will be dynamically loaded here by JavaScript -->
        </div>

        <div id="end-of-content-marker" class="loading-packet">END OF AVAILABLE ARCHIVE. SCROLL TO LOAD MORE.</div>
    </div>
    
    <!-- Hamburger Menu Icon -->
    <div id="hamburger-menu" class="hamburger-menu">
        <div class="hamburger-menu-icon">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </div>
    
    <!-- Audio Control Button -->
    <div id="audio-control" class="audio-control">
        <i class="fas fa-volume-up"></i>
    </div>

    <!-- Collapsible Filter Sidebar -->
    <div id="filter-sidebar" class="filter-sidebar">
        <h2 class="text-2xl text-center text-red-400 font-bold mb-8 uppercase tracking-wider">Archive Filters</h2>

        <div class="filter-group">
            <h3>By Season</h3>
            <div id="season-filters" class="flex flex-col gap-2">
                <button data-filter-type="season" data-filter-value="1">Season One</button>
                <button data-filter-type="season" data-filter-value="2">Season Two</button>
            </div>
        </div>

        <div class="filter-group">
            <h3>By Character</h3>
            <div id="character-filters" class="flex flex-col gap-2">
                <!-- Character buttons will be dynamically added here -->
            </div>
        </div>

        <div class="filter-group">
            <h3>By Timeline</h3>
            <div id="timeline-filters" class="flex flex-col gap-2">
                <button data-filter-type="timeline" data-filter-value="A">Ancient Past (A)</button>
                <button data-filter-type="timeline" data-filter-value="B">The Present (B)</button>
                <button data-filter-type="timeline" data-filter-value="C">The Far Future (C)</button>
            </div>
        </div>
        
        <div class="filter-group">
            <h3>By Log Type</h3>
            <div id="log-type-filters" class="flex flex-col gap-2">
                <button data-filter-type="type" data-filter-value="visual-archive">Visual Archive</button>
            </div>
        </div>

        <button id="show-all-btn" class="all-button w-full py-3 mt-4 text-center font-bold text-lg bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors active">Show All Entries</button>
    </div>
    
    <!-- Easter Egg Modal -->
    <div id="easter-egg-modal" class="video-modal-overlay">
        <div id="easter-egg-modal-content">
            <button id="easter-egg-close-btn" class="close-btn">&times;</button>
            <h3>ARCHIVE CORRUPTED: KERNEL OVERRIDE</h3>
            <p>"A Collaborative work of fiction between The Pagemaster & The Architect"</p>
            <p class="mt-4 text-xs">
                ACCESS VIOLATION DETECTED. UNAUTHORIZED DATA SEGMENT.
            </p>
            <div class="puzzle-container">
                <div class="puzzle-symbol" data-order="1">☗</div>
                <div class="puzzle-symbol" data-order="2">⨁</div>
                <div class="puzzle-symbol" data-order="3">⍟</div>
                <div class="puzzle-symbol" data-order="4">⍦</div>
            </div>
        </div>
    </div>
    
    <!-- Back to Top Button -->
    <button id="back-to-top" title="Back to Top">
        <!-- New proto-geometric SVG for a thematic feel -->
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2L2 12h5v10h10V12h5L12 2zM9 14v4H7v-4h2zm8 0v4h-2v-4h2z"/>
        </svg>
    </button>
    
    <!-- Video Log Modal -->
    <div id="video-modal" class="video-modal-overlay">
        <div class="video-modal-content">
            <button class="close-btn">&times;</button>
            <h3>Video Log Playback</h3>
            <div id="video-modal-content">
                <div id="video-player" class="video-player">
                    <!-- The image is no longer displayed for video logs, only a static effect -->
                    <div class="static-overlay"></div>
                    <div class="video-status-text">
                        VIDEO FILE CORRUPTED<br>
                        DATA LOSS 99.9%
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            let logsData = [];
            
            const logsPerPage = 10;
            let loadedLogsCount = 0;
            let allLogsLoaded = false;
            let hasFoundSecret = false;
            
            const logEntriesContainer = document.getElementById('log-entries');
            const endOfContentMarker = document.getElementById('end-of-content-marker');
            const loadingOverlay = document.getElementById('loading-overlay');
            const mainContainer = document.getElementById('log-container');

            const hamburgerMenu = document.getElementById('hamburger-menu');
            const filterSidebar = document.getElementById('filter-sidebar');
            const showAllBtn = document.getElementById('show-all-btn');
            const backToTopBtn = document.getElementById('back-to-top');
            const audioControl = document.getElementById('audio-control');
            const audioIcon = audioControl.querySelector('i');
            const backgroundAudio = document.getElementById('background-audio');
            const easterEggTrigger = document.getElementById('easter-egg-trigger');
            const easterEggModal = document.getElementById('easter-egg-modal');
            const puzzleSymbols = document.querySelectorAll('.puzzle-symbol');
            const easterEggCloseBtn = document.getElementById('easter-egg-close-btn');

            // Video Log Modal
            const videoModal = document.getElementById('video-modal');
            const videoPlayer = document.getElementById('video-player');
            const videoModalCloseBtn = document.querySelector('#video-modal .close-btn');
            
            let activeFilters = {
                season: [],
                character: [],
                timeline: [],
                type: [],
            };
            let allLogsVisible = true;
            
            // --- Helper Functions ---
            const toggleSidebar = () => {
                hamburgerMenu.classList.toggle('open');
                filterSidebar.classList.toggle('open');
            };

            const playAudio = () => {
                // Audio is disabled as per user request
                // if (backgroundAudio.paused) {
                //     backgroundAudio.play().catch(e => console.error("Audio playback was blocked by browser:", e));
                // }
            };
            
            const toggleAudio = () => {
                // Audio is disabled as per user request
                // backgroundAudio.muted = !backgroundAudio.muted;
                // audioControl.classList.toggle('muted', backgroundAudio.muted);
                // audioIcon.className = backgroundAudio.muted ? 'fas fa-volume-mute' : 'fas fa-volume-up';
            };
            
            const smoothScrollToTop = () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };
            
            // --- UI Event Listeners ---
            hamburgerMenu.addEventListener('click', toggleSidebar);
            document.body.addEventListener('click', playAudio, { once: true }); // Play audio on first user interaction
            audioControl.addEventListener('click', toggleAudio);
            backToTopBtn.addEventListener('click', smoothScrollToTop);
            
            // Easter egg trigger
            if (easterEggTrigger) {
                easterEggTrigger.addEventListener('click', () => {
                    easterEggModal.classList.add('show');
                });
            }
            
            // Easter egg close button listener
            easterEggCloseBtn.addEventListener('click', () => {
                closeModal(easterEggModal);
            });
            
            let puzzleClicks = [];
            const correctOrder = [1, 3, 2, 4];
            
            puzzleSymbols.forEach(symbol => {
                symbol.addEventListener('click', () => {
                    const order = parseInt(symbol.dataset.order);
                    puzzleClicks.push(order);
                    symbol.classList.add('active');
                    
                    if (puzzleClicks.length === correctOrder.length) {
                        const isCorrect = puzzleClicks.every((val, index) => val === correctOrder[index]);
                        if (isCorrect) {
                            puzzleSymbols.forEach(s => {
                                s.classList.remove('active');
                                s.classList.add('correct');
                            });
                            // Unlock the secret log
                            if (!hasFoundSecret) {
                                const secretLog = logsData.find(log => log.id === 'log-corrupted-data');
                                if (secretLog) {
                                    logsData.push(secretLog);
                                    hasFoundSecret = true;
                                }
                            }
                            
                            setTimeout(() => closeModal(easterEggModal), 2000);
                        } else {
                            puzzleSymbols.forEach(s => {
                                s.classList.remove('active');
                                s.classList.add('incorrect');
                            });
                            setTimeout(() => {
                                puzzleSymbols.forEach(s => s.classList.remove('incorrect'));
                                puzzleClicks = [];
                            }, 1000);
                        }
                    }
                });
            });

            // Generic modal close function
            const closeModal = (modal) => {
                modal.classList.remove('show');
            }
            
            videoModalCloseBtn.addEventListener('click', () => {
                videoPlayer.classList.remove('has-static');
                closeModal(videoModal);
            });
            
            window.addEventListener('scroll', () => {
                if (window.scrollY > 300) {
                    backToTopBtn.style.display = 'flex';
                } else {
                    backToTopBtn.style.display = 'none';
                }
            });
            
            const handleVideoPlayback = (log) => {
                videoPlayer.classList.add('has-static');
                videoModal.classList.add('show');
            };

            const fetchLogs = async () => {
                const publicUrl = './content.json';
                
                try {
                    const response = await fetch(publicUrl);
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return await response.json();
                } catch (error) {
                    console.error('Could not fetch logs:', error);
                    // Fallback to a single, hardcoded error log if fetching fails
                    return [{
                        id: 'error-log',
                        type: 'system-status-update',
                        timeline: 'C',
                        season: '1',
                        characters: ['System'],
                        header: '[SYSTEM LOG - FETCH ERROR]',
                        content: `ERROR: Failed to retrieve archived data from the same-origin URL. This may happen if the JSON file is missing or has a malformed filename.`
                    }];
                }
            };

            function initializeFilters() {
                // Collect unique filter values from the data
                const allCharacters = [...new Set(logsData.flatMap(log => log.characters))].filter(Boolean).sort();
                const allTypes = [...new Set(logsData.map(log => log.type))].filter(Boolean).sort();
            
                // Populate the filter buttons for characters
                const characterFiltersContainer = document.getElementById('character-filters');
                characterFiltersContainer.innerHTML = '';
                allCharacters.forEach(character => {
                    const button = document.createElement('button');
                    button.textContent = character;
                    button.dataset.filterType = 'character';
                    button.dataset.filterValue = character;
                    characterFiltersContainer.appendChild(button);
                });
                
                // Populate the filter buttons for log types
                const logTypeFiltersContainer = document.getElementById('log-type-filters');
                logTypeFiltersContainer.innerHTML = '';
                allTypes.forEach(type => {
                    const button = document.createElement('button');
                    button.textContent = type.replace(/-/g, ' ').split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
                    button.dataset.filterType = 'type';
                    button.dataset.filterValue = type;
                    logTypeFiltersContainer.appendChild(button);
                });
                
                // Attach event listeners to all filter buttons
                const filterButtons = document.querySelectorAll('.filter-group button');
                filterButtons.forEach(button => {
                    button.addEventListener('click', (e) => {
                        const { filterType, filterValue } = e.target.dataset;
                        
                        if (['season', 'timeline', 'type'].includes(filterType)) {
                            document.querySelectorAll(`[data-filter-type="${filterType}"]`).forEach(btn => btn.classList.remove('active'));
                        }
                        
                        e.target.classList.toggle('active');

                        if (e.target.id === 'show-all-btn') {
                            document.querySelectorAll('.filter-group button').forEach(btn => btn.classList.remove('active'));
                            e.target.classList.add('active');
                            activeFilters = { season: [], character: [], timeline: [], type: [] };
                            allLogsVisible = true;
                        } else {
                            if (e.target.classList.contains('active')) {
                                activeFilters[filterType].push(filterValue);
                            } else {
                                activeFilters[filterType] = activeFilters[filterType].filter(v => v !== filterValue);
                            }
                            allLogsVisible = false;
                            showAllBtn.classList.remove('active');
                        }
                        
                        loadedLogsCount = 0;
                        renderLogs();
                        toggleSidebar();
                    });
                });
            }
            
            function filterLogs() {
                if (allLogsVisible) {
                    return logsData;
                }
                
                return logsData.filter(log => {
                    const matchesSeason = activeFilters.season.length === 0 || activeFilters.season.includes(log.season.toString());
                    const matchesCharacter = activeFilters.character.length === 0 || log.characters.some(c => activeFilters.character.includes(c));
                    const matchesTimeline = activeFilters.timeline.length === 0 || activeFilters.timeline.includes(log.timeline);
                    const matchesType = activeFilters.type.length === 0 || activeFilters.type.includes(log.type);

                    return matchesSeason && matchesCharacter && matchesTimeline && matchesType;
                });
            }
            
            function loadMoreLogs() {
                const filteredLogs = filterLogs();
                if (loadedLogsCount >= filteredLogs.length) {
                    allLogsLoaded = true;
                    endOfContentMarker.style.display = 'block';
                    endOfContentMarker.textContent = 'END OF ARCHIVE.';
                    return;
                }

                const newLogsToLoad = filteredLogs.slice(loadedLogsCount, loadedLogsCount + logsPerPage);
                newLogsToLoad.forEach(log => {
                    const logEntryDiv = createLogElement(log);
                    logEntriesContainer.appendChild(logEntryDiv);
                    observer.observe(logEntryDiv);
                    
                    if (log.image) {
                        const imageContainerDiv = document.createElement('div');
                        imageContainerDiv.className = 'image-container gibberish';
                        imageContainerDiv.id = `image-${log.id}`;
                        const imgElement = document.createElement('img');
                        imgElement.src = log.image;
                        imgElement.alt = log.imageAlt;
                        imageContainerDiv.appendChild(imgElement);
                        logEntriesContainer.appendChild(imageContainerDiv);
                        observer.observe(imageContainerDiv);
                    }
                });

                loadedLogsCount += newLogsToLoad.length;
            }

            function createLogElement(log) {
                const logEntryDiv = document.createElement('div');
                logEntryDiv.className = `log-entry log-type-${log.type}`;
                logEntryDiv.id = `log-${log.id}`;
                
                const logHeaderDiv = document.createElement('div');
                logHeaderDiv.className = 'log-header';
                logHeaderDiv.textContent = log.header;
                logEntryDiv.appendChild(logHeaderDiv);
                
                if (log.content) {
                    const logContentPre = document.createElement('pre');
                    logContentPre.className = 'log-content';

                    if (log.type.includes('ai-dialogue') || log.type === 'system-log-aurora-prime') {
                        const processedContent = log.content.replace(/(CONSERVATOR:)/g, '<span class="conservator-text">CONSERVATOR:</span>')
                                                            .replace(/(LEGION:)/g, '<span class="legion-text">LEGION:</span>')
                                                            .replace(/(AURORA-PRIME:)/g, '<span class="aurora-text">AURORA-PRIME:</span>')
                                                            .replace(/(::.*?::)/g, '<span class="glow">$1</span>');
                        logContentPre.innerHTML = processedContent;
                    } else {
                        logContentPre.textContent = log.content;
                    }

                    logEntryDiv.appendChild(logContentPre);
                }
                
                if (log.type === 'end-of-archive') {
                    logEntryDiv.classList.add('end-of-archive');
                }

                // Add video log button if applicable
                if (log.type === 'video-log') {
                     const interactionContainer = document.createElement('div');
                    interactionContainer.className = 'log-interaction-container';
                    const button = document.createElement('button');
                    button.className = 'log-button video-button';
                    button.innerHTML = '<i class="fas fa-play"></i> Play Video Log';
                    button.addEventListener('click', () => handleVideoPlayback(log));
                    interactionContainer.appendChild(button);
                    logEntryDiv.appendChild(interactionContainer);
                }
                
                return logEntryDiv;
            }
            
            function renderLogs() {
                logEntriesContainer.innerHTML = '';
                const filteredLogs = filterLogs();
                
                if (filteredLogs.length === 0) {
                    logEntriesContainer.innerHTML = `<div class="loading-packet">NO LOGS FOUND MATCHING YOUR CRITERIA.</div>`;
                    endOfContentMarker.style.display = 'none';
                    return;
                }
                
                const initialLogs = filteredLogs.slice(0, logsPerPage);
                initialLogs.forEach(log => {
                    const logElement = createLogElement(log);
                    logEntriesContainer.appendChild(logElement);
                    observer.observe(logElement);
                    
                    if (log.image) {
                        const imageContainerDiv = document.createElement('div');
                        imageContainerDiv.className = 'image-container gibberish';
                        imageContainerDiv.id = `image-${log.id}`;
                        const imgElement = document.createElement('img');
                        imgElement.src = log.image;
                        imgElement.alt = log.imageAlt;
                        imageContainerDiv.appendChild(imgElement);
                        logEntriesContainer.appendChild(imageContainerDiv);
                        observer.observe(imageContainerDiv);
                    }
                });

                loadedLogsCount = initialLogs.length;

                if (loadedLogsCount < filteredLogs.length) {
                    endOfContentMarker.style.display = 'block';
                    endOfContentMarker.textContent = 'END OF AVAILABLE ARCHIVE. SCROLL TO LOAD MORE.';
                } else {
                    endOfContentMarker.style.display = 'block';
                    endOfContentMarker.textContent = 'END OF ARCHIVE.';
                }
            }

            // --- Intersection Observer Setup ---
            const observerOptions = {
                root: null,
                rootMargin: '0px 0px -20% 0px',
                threshold: 0.1
            };
            
            const loadMoreObserverOptions = {
                root: null,
                rootMargin: '0px',
                threshold: 0
            };
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    const element = entry.target;
                    const isLogEntry = element.classList.contains('log-entry');
                    const isImageContainer = element.classList.contains('image-container');

                    if (entry.isIntersecting) {
                        element.classList.remove('gibberish');
                        element.classList.add('is-visible');
                    } else {
                        element.classList.add('gibberish');
                        element.classList.remove('is-visible');
                    }
                });
            }, observerOptions);

            const loadMoreObserver = new IntersectionObserver((entries) => {
                if (entries[0].isIntersecting && !allLogsLoaded) {
                    loadMoreLogs();
                }
            }, loadMoreObserverOptions);

            // --- Main application startup ---
            const publicUrl = './content.json';
            
            fetch(publicUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    logsData = data;
                    loadMoreObserver.observe(endOfContentMarker);
                    initializeFilters();
                    renderLogs();
                    setTimeout(() => {
                        loadingOverlay.classList.add('hidden');
                        mainContainer.classList.remove('hidden');
                        backToTopBtn.style.opacity = '1';
                        backToTopBtn.style.transform = 'translateY(0)';
                    }, 2000);
                })
                .catch(error => {
                    console.error('Could not fetch logs:', error);
                    loadingOverlay.classList.add('hidden');
                    mainContainer.classList.remove('hidden');
                    logEntriesContainer.innerHTML = `<div class="loading-packet">CRITICAL ERROR: Failed to load application data. Please ensure 'content.json' exists in the same directory.</div>`;
                });
        });
    </script>
</body>
</html>

